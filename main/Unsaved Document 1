select ln_seq, action_date, gl_mas_code, gl_mas_desc, particulars, debit, credit from (select '0' as ln_seq, 'O' as tran_id, to_date('2010-03-31','yyyy-mm-dd')  as action_date, a.gl_mas_code, b.gl_mas_desc, 'Opening Balace' as particulars, sum(debit-credit) as debit, 0.00 as credit from mas_gl_tran as a,  gl_master as b where a.gl_mas_code= b.gl_mas_code and a.action_date < to_date('2010-03-31','yyyy-mm-dd')  group by a.gl_mas_code, b.gl_mas_desc having sum(debit-credit)> 0 union all select '0' as ln_seq, 'O', to_date('2010-03-31','yyyy-mm-dd') , a.gl_mas_code, b.gl_mas_desc, 'Opening Balance   ' as particulars, 0.00 as debit, sum(credit-debit) as credit from mas_gl_tran as a,  gl_master as b where a.gl_mas_code= b.gl_mas_code  and a.action_date < to_date('2010-03-31','yyyy-mm-dd')  group by a.gl_mas_code, b.gl_mas_desc having sum(debit-credit)<= 0 union all select '1' as ln_seq, a.tran_id, a.action_date, a.gl_mas_code, b.gl_mas_desc, a.particulars, debit as debit, credit as credit from mas_gl_tran as a,  gl_master as b where a.gl_mas_code= b.gl_mas_code and action_date between to_date('2010-03-31','yyyy-mm-dd')  and to_date('2011-03-31','yyyy-mm-dd') ) as a order by gl_mas_code, action_date, ln_seq;
